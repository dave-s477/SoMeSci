Growth of bacterial strains, and genomic and plasmid DNA isolation: Genomic DNA was isolated from overnight cultures as follows: each initial pure culture sample was taken from frozen stock, plated on Trypticase Soy Agar, and incubated overnight at 37°C. After incubation, cells were taken from the plate and inoculated into Trypticase Soy Broth and cultured for DNA extraction. All samples were representative cultures from a full-plate inoculation and were not single colonies. Genomic DNA was extracted using Qiagen DNeasy kits. The cilantro samples were provided through the U.S. Department of Agriculture (USDA) Microbiological Data Program (MDP). Samples collected in Michigan, Florida, New York, Ohio, and Washington were shipped overnight at room temperature and processed immediately upon receipt for the presence of S. enterica. Cilantro was weighed into sterile Whirl-Pak bags, 100 g per sample, and 500 ml of modified Buffered Peptone Water (mBPW) [35] was added to each bag. The samples were manually mixed for 2 min and then incubated overnight at 37°C. The overnight enrichment cultures were subcultured into Tetrathionate Broth (TB) and Rappaport-Vassiliadis (RV) media and incubated according to the Bacteriological Analytical Manual (BAM) Chapter 5 Salmonella [36]. Following overnight incubation the TB and RV cultures were streaked onto Hektoen Enteric (HE), Xylose-Lysine-Tergitol 4 (XLT-4), and Bismuth Sulfite (BS) agar plates and the plates were incubated overnight at 37°C. Colonies demonstrating typical S. enterica morphology on each selective agar plate were subcultured onto 5% Sheep Blood Agar (SBA) plates for further characterization. Colonies from SBA plates were confirmed as Salmonella using the Vitek® 2 Compact. The serotype was determined using the Premitest ® following the manufacturer’s instructions and a PCR serotyping method [37]. The PFGE pattern for each isolate was also determined using the CDC method for S. enterica.

Library construction and genome sequencing: For this study, 71 S. Tennessee isolates from a variety of sources were sequenced. Of these, 42 isolates were shotgun sequenced using the Roche 454 GS Titanium NGS technology [38]. Each isolate was run on one quarter of a Titanium plate, producing roughly 250,000 reads per draft genome and providing an average genome coverage of ~20X. Illumina MiSeq™ was used to sequence 28 isolates. The remaining isolate served as our reference for mapping; it was used to prepare a single 10 kb library following the Pacific Biosciences sample preparation methods for C2 chemistry. That 10 kb library was then sequenced using PacBio RS II on 4 single-molecule real-time (SMRT) cells using a 120-minute collection protocol, which provided a closed genome with an average genome coverage of > 200X. Our taxon sampling also included one S. Kentucky and one S. Cubana genome (Table 1), which were sequenced using Roche 454 GS Titanium and Illumina Miseq™ chemistries, respectively. These two Salmonella serotypes, Cubana (Genbank accession APAG0000000) and Kentucky (Genbank accession AOYZ00000000) had previously been shown to be close relatives to S. Tennessee [39], and hence served as outgroups in this study.

Table data removed from full text. Table identifier and caption: 10.1371/journal.pone.0146929.t001 Isolates and metadata from the peanut butter-derived sources, including samples obtained from outbreak-associated foods and clinical samples. Libraries were constructed from cilantro-derived samples using the Nextera XT DNA sample preparation kit (Illumina, San Diego, CA), and whole-genome sequencing was performed on a MiSeq™ benchtop sequencer (Illumina, San Diego, CA), using 500-cycle paired-end reagent kit v2.

De novo assemblies were created for each isolate, using Roche Newbler package (v. 2.6), CLC Genomic Workbench 6.5.1, and SMRT analysis 2.0.1, for isolates sequenced by 454, Miseq™, and PacBio, respectively. All draft genomes were annotated using NCBI’s Prokaryotic Genomes Automatic Annotation Pipeline (PGAAP, [40]). The reference genome used for mapping reads was CFSAN001339, which is comprised of 1 single circular chromosome. Hence, positional information is specific for the reference. (GenBank accession: CP007505). Phylogenetic trees were constructed using GARLI [41, 42] under the maximum likelihood criterion. The phylogenetic tree in Fig 2 was constructed using GARLI under the GTR + gamma model of nucleotide evolution. Phylogenetic analyses of the data set, including multiple outgroups, were performed on the concatenated SNP matrix described above.

The raw reads of each sample were mapped to the closed reference genome, CFSAN001339, using Novoalign V2.08.02 (http://www.novocraft.com), and the variants were called using SAMtools and stored in a VCF file [43]. A custom Python script was used to read through each VCF file and construct a SNP matrix for further phylogenetic analyses, as follows. First, we estimated the site SNP allele frequencies of the strongest non-reference allele [43] and placed them into a list by collecting all of the instances which met the criteria of being present at positions in the reference where one or more isolates differed with a read depth ≥10 and an allele frequency equal to one. Insertions and deletions (indels) in VCF files were ignored. Second, pileup files were generated for each isolate based on the above-mentioned list to determine the appropriate nucleotide state for positions in the list for each isolate based on the following rules: a) if there was no mapped reads at a position it was treated as missing data; b) if different nucleotides were called at the position, the one with frequency larger than 50% was the consensus call for that position; and c) if different nucleotides were called at a position but none had a frequency larger than 50%, that position for that individual isolate was coded as missing data. Third, the mapped consensus base for each isolate at the reference SNP positions were concatenated in a multiple FASTA file for phylogenetic analysis. The maximum likelihood (ML) tree was constructed using GARLI [41,42] with 200 ML replicates and 1000 bootstrap replicates. All GARLI analyses were performed with the default parameter settings and the GTR+gamma nucleotide substitution model. Detailed descriptions of the data analysis pipeline is available [44] as well as github (see https://github.com/CFSAN-Biostatistics/snp-mutator).

The whole genome shotgun accessions (WGS), Bioproject accession numbers, and metadata for all the isolates sequenced in this study are listed in Table 1. The NCBI accession numbers for the comparative plasmids discussed herein are: Citrobacter freundii plasmid pCAV1741-110 (CP011655); S. Typhi plasmid pHCM2 (AL513384); and Yersinia pestis pMT (CP010021).

