The study was conducted in Cabañeros National Park (39° 23′ 47″ N; 4° 29′ 14″ W; altitude varies between 560 and 1448 m), a natural area of 40856 ha located in central Spain. The climate is Mediterranean, the annual average temperature fluctuates from 12.9 to 15.6°C and the annual precipitation averages between 500 and 750 mm [27]. The park is constituted by extensive areas of well-preserved Mediterranean landscape, with various woodland types [27].Field work was carried out in the most representative Mediterranean forests of the National Park: sclerophyllous forest of holm-oak Quercus rotundifolia Lam., mixed deciduous forest dominated by Pyrenean oak Quercus pyrenaica Willd. and the native oak Quercus faginea Lam., and riparian forest of narrow-leafed ash Fraxinus angustifolia Vahl. To capture saproxylic insects breeding and inhabiting tree hollows we used emergence traps specially modified from Colas [28]. Every tree hollow was covered with acrylic mesh and sealed up with staples. Specimens emerged and come into a white collecting pot containing ethylene glycol as preservative [21], [28]. In every forest type we selected 30, 30 and 27 hollow trees, respectively. The first indispensable necessity for study basic specialized patterns occurring on saproxylic communities inhabiting this ecological niche was to represent the real heterogeneity and abundance of tree hollows in each woodland type, always having account the high degree of protection of this National Park and the inherent need to protect and conserve this important and limited microhabitat. We considered a maximum of 30 tree hollows representing the natural proportion per woodland type, including multiple ecological variables able to model saproxylic communities at microhabitat scale in the studied area, as hollow size, hollow position, tree diameter, etc. [30], [18], [19]. This passive method of capture allows recording saproxylic species shortly after their emergence from immature stages, offering a representative outline of the linkage of any recorded species to this microhabitat, being the interaction strength a good surrogate of this linkage. Collecting tubes were replaced every month throughout a year (February 2009–March 2010).

We selected Coleoptera and Diptera as study groups at the hollow level, because they are the best known and represented groups in forests [30]–[32], allowing us to study the network properties from a quantitative point of view. We considered the Syrphidae as a bioindicator of species and interaction richness among the Diptera, because i) they have been traditionally used next to beetles in studies concerning saproxylic insects [33], [34], and present a high number of saproxylic species around Europe [33], using a wide range of microhabitats [35], what has led them to be used as indicators of woodland quality [24], [34], to be flagships for the conservation of the wider community of saproxylic organisms [35] or to be included in national red lists [36], and ii) they represent the best studied family (or just the unique) of Diptera in the study site, presenting high number and abundance of mainly exclusive saproxylic species highly strengthened with tree hollow microhabitats [20]. Identification of Coleoptera families was done using Delvare and Aberlenc keys [37], and for species identification of many families we also counted with the help of invited specialists (see Acknowledgments). Syrphids were identified using the van Veen [38] and Speight keys [39].

Classification into Levels of Interaction: Saproxylic communities are complex networks involving different types of interactions that depend on different trophic resources available inside tree hollow microhabitats. Because of the large number of both tree hollows and species nodes, we began breaking down the crude network into smaller sub-networks, recording biological/ecological information available for this saproxylic functional group, using the bibliography, the ‘Frisbee’ data base [40] and expert’s information (see Acknowledgements). Clear facultative associations and species with unknown biology were removed for the analyses. For this objective, we classified the saproxylic entomofauna according to the main ecological guilds described by Speight [24] and Bouget et al. [41]: xylophagous, xylomycetophagous, saprophagous, predators and commensals (Table S1). Finally, based on the use of trophic resources on hollow trees, we classified the whole saproxylic community in two basic levels: 1) according to the type of interaction, a) direct saproxylic insects (wood-dependent), feeding on woody resources, as dead or dying wood, sap run or wood-inhabiting fungi, and b) insect-dependent sub-networks (insect-dependent), inhabiting tree hollows but mainly depending on the activity or presence of other saproxylic insects for their development: predators and commensals., and 2) according to trophic guilds: i) xylophagous, ii) saprophagous, iii) xylomycetophagous (wood-dependent sub-networks), and iv) predators and v) commensals (insect-dependent sub-networks).

We used Aninhado [3] to analyse the existence of nestedness patterns (nestedness as NODF estimator), generating 1000 replicates for each saproxylic sub-network with a CE null model. CE considers that the probability of an interaction is proportional to the generalisation level of both species, so allowing evaluating the influence of abundances to nestedness pattern. To study modularity we used ‘netcarto’ [5] and Pajek [42]. For a given partition of the nodes of a network into modules, the modularity M of this partition is [43]–[45]:(1)where NM is the number of modules, L is the number of links in the network, ls is the number of links between nodes in module s, and ds is the sum of the degrees of the nodes in module s. This heuristic module identification algorithm finds the minimum partition into modules. A good partition of a network must comprise many within-module links and as few as possible between-module links. Equation (1) does that by imposing that M = 0 if nodes are placed at random into modules or if all nodes are in the same cluster [5], [43]–[45]. We assessed the simulated annealing procedure to find the optimal partition with largest modularity of the network into modules [46]. This stochastic optimization technique enables to find ‘low-cost’ configuration without getting trapped in ‘high-cost’ local minima, by means of the introduction of computational temperature T. When T is high, the system can explore configurations of high cost whereas at low T the system only explores low-cost regions. By starting at high T and slowly decreasing T, the system descends gradually towards deep minima, eventually overcoming small cost barriers. When identifying modules, the objective is to maximize the modularity, and thus the cost is C = –M, where M is the modularity as defined in equation (1). At each temperature, we perform a number of random updates (1000, f (iteration factor) = 0.1, c (cooling factor) = 0.995) and accept them with probability p [47]:(2)where Cf is the cost after the update and Ci is the cost before the update. We also used ‘netcarto’ to heuristically describe the differences on the composition and interrelations among modules along 25 randomisations maximizing modularity (subjective benchmark). We considered that the partition with a lesser number of modules could be used as the ‘minimum partition with largest optimisation of modularity’ for each randomised sub-network, from we can know the main minimal subsets of interacting nodes or sub-modules of any modular network. Based on the connectivity in these resultant sub-modules, we yielded and studied the cartographic representation of the complex network [43]. We obtained the within-module degree for each node. If ki is the number of links of node i to other nodes in its module si,  is the average of k over all the nodes in si, and is the standard deviation of k in si, then:(3)is so-called Z-score (z ≥2.5 determines hub nodes, and z <2.5 non-hubs nodes), which measures how well-connected node i is to other nodes in the module. To assess the connection of a node to modules other than its own, we obtained the P-score or participation coefficient Pi of each node i as: (4)where  is the number of links of node i to nodes in module s, and ki is the total degree of node i. The P-score of a node ranges between 0 if all the links are done within-module and 1 if the links are uniformly distributed along the set of sub-modules. According to these values, we then classified each node into system independent ‘universal roles’: kinless hub (R7), connector hub (R6), provincial hub (R5), non-hub kinless (R4), non-hub connector (R3), peripheral (R2) and ultra-peripheral (R1), analysing their number and distribution along sub-modules and implications on modularity patterns.

We used ‘R-bipartite’ [48] to quantitatively assess interacting and distributional patterns between trophic levels of each sub-network and the set of tree hollows assessed. Network attributes analysed were links (mean number of links per species [defined as the sum of links divided by the number of species]), species degree (the sum of the diversity of links per species), interaction strength (sum of dependencies for each species), connectance (the proportion of realised links of the total possible in each network [defined as the sum of links divided by the number of cells in the matrix]), linkage density (a quantitative measure defined as the mean number of interactions per species), H2′ (a measure of network specialisation [which ranges between 0: no specialisation, and 1: complete specialisation]), V-ratio (Variance-ratio of species numbers to individual numbers within species for the higher trophic level [values larger than 1 indicate positive aggregation or association, values between 0 and 1 indicate disaggregation of species]).

We assessed microhabitat relevance throughout the simulation of primary extinction (slope-estimation derived from randomly removing tree hollow nodes of the lower trophic level) and secondary extinctions approach [49] [slope of the secondary extinction sequence to species in the higher trophic level, following an extermination of highly interconnected tree hollows in the lower trophic level]). We only performed network robustness to species extinctions for insects (higher trophic level) because the set of tree hollows (lower trophic level) is not really affected by removing saproxylic insects. We also studied sub-network robustness [50] as a measure of the system to the random and directed lost of tree hollows (the area below a extinction curve, where R = 1 correspond to a curve that decreases very mildly up to the point at which almost all animal species are eliminated, whereas with R = 0 the curve decreases abruptly as soon as any species is lost). The analyses were carried out separately for each sub-network.

