We adopt modularity-based community detection methods, which are adapted to correlation matrices. Respectively, this restrict us to undirected networks, as a result of sharing by definition the same symmetry property as correlation matrices. Let us consider a network with N nodes, one can introduce a number of partitions of the N nodes into non-overlapping sets. The different partitions will be represented by an N-dimensional vector σ→ where the i-th component σi denotes the set in which node i is placed by that particular partition. Now, we introduce the modularity measure Q(σ→) which indicates the quality of a specific choice of partition σ→ measured by high degree of inter community connectivity and a low degree of intra community connectivity. The modularity optimization algorithms look for the specific partition that maximizes the value of Q(σ→), the objective function. It is defined as Q(σ→)=1Atot∑i,j[Aij-⟨Aij⟩]δ(σi,σj)(13) where δ(σi, σj) is a delta function ensuring that only when σi = σj (nodes within the same community) does it contribute to the sum, and Aij is the adjacency matrix that indicates whether a link exists between the nodes, Aij = 1 or not, Aij = 0 (in the binary representation). The pre-factor Atot serves to normalize the value of Q(σ→) between −1 and 1, where Atot ≡ ∑i, j Aij = 2L is twice the number of total links in the network. The term ⟨Aij⟩ is vital to the outcome of the community detection process. It represents the expectation of whether a link exists or not, according to the specific null model that you consider. So far the majority of the methods use null models (hypotheses), which are suited only for networks. For example the configuration model, that preserves the degree sequence (or strength sequence) of the network. It has been shown that such null models can introduce biases when applied to correlation matrices [7]. Instead, a recent method proposed a redefinition of the modularity, which takes into account the existence of known spectral properties in correlation matrices (see Spectral Analysis). Now, instead of the previous adjacency matrix Aij, we input the empirical correlation matrix Cij. The first is the global mode C(m)(market mode in a financial setting), which represents the common movement of the market. In other words, in order to clearly differentiate between the mesoscopic groups, one must subtract out the main drift of the market. The second is the random bulk C(r) C(r)=∑i:λi≤λ+λi|vi⟩⟨vi|(14) which corresponds to random correlation between the different time series. In order to filter this noise, one must use random matrix theory (RMT) [26], to identify the random properties of empirical correlation matrices. The method define the modularity as Q(σ→)=1Cnorm∑i,j(Cij-Cij(r)-Cij(m))δ(σi,σj)=1Cnorm∑i,jCij(g)δ(σi,σj)(15) constituted from the eigenvalues {λi} less than or equal to λ+ (usually, the eigenvalues smaller than λ− are included as well) and their corresponding eigenvectors vi. The new method modified three popular community detection algorithms, customizing where necessary to be effective with correlation matrices [7]. The three algorithms we use in this paper are known as the Potts (or spin glass) method [12, 13], the Louvain method [14] and the spectral method [15]. For replicating the analysis one can use various types of financial times series. In this paper, we analyzed daily closing prices of stocks from three different indexes. The data was retrieved from a number of sites [33–35], which allow extraction of historical price data per ticker (stock identifier). Very practically, the data (multiple stock quotes) can be directly imported into a single file (for example [36]). Additionally, a code implementing all the methods discussed in this section (with the adaptations discussed in the Appendix) is available here [37, 38].

