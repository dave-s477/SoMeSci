In this study, human subject ethical approval was sought from the Human Ethics Committee of the Hong Kong Polytechnic University, and all the subjects were explained with the experimental protocol and asked to sign on the informed consent form prior to the experiment.

Vibro-ultrasound System for Muscle Stiffness Measurement: The vibro-ultrasound system consisted of a mechanical vibrator, a programmable ultrasound scanner and a custom-made program for radio-frequency data acquisition. An electromagnetic vibrator (minishaker type 4810, Brüel & Kjær, Nærum, Denmark) which was driven by a power amplifier and controlled by a function generator was used to induce shear waves in the muscle. The vibrator impacted the muscle with a monochromatic low-frequency sinusoidal pulse. In general, the vibration frequency typically adopted in previous studies ranged from 90 to 150 Hz for skeletal muscle stiffness assessment [42], [43]. In this study, 100 Hz frequency was selected to ensure a more reasonable comparison with those studies. As demonstrated in Fig. 2 (left), shear waves with 10 cycles generated by the external vibrator propagated in the muscle action direction. An ultrasound linear array probe was placed along this direction. At the proximal and distal positions, the tissue movements were monitored by two separated ultrasound scan lines. The distance between the two scan lines was Δr (in this study, 15 mm was used) and the time delay between the two detected waveforms was Δt. Then the wave velocity cs could be calculated by: Figure data removed from full text. Figure identifier and caption: 10.1371/journal.pone.0101769.g002 Diagram of the vibro-ultrasound system for shear wave velocity measurement using two ultrasound scan lines (left) and the position of the ultrasound probe and the vibrator during the experiment on one human subject (right).The three positions of the vibrator used for the different vibro-beam distance test were also indicated. (2)The ultrasound data acquisition system was developed based on a commercial ultrasound scanner SonixRP (Ultrasonix Medical Corp. Vancouver, Canada) with a 5–14 MHz linear array probe (driven by the central frequency 9.5 MHz), and its software developing kits applicable to Visual C++ (Microsoft Corporation, USA). A custom-designed ultrasound transmission and reception sequence was implemented. B-mode images were first acquired (with 256 scan lines corresponding to a 38 mm width) using a predefined penetration depth of 65 mm for helping position the probe at the expected place with a right orientation. For minimizing the anisotropic effects of wave propagation, a straight short push-bar was mounted on the piston of the vibrator and its position was carefully adjusted to guarantee the shear wave would propagate in the muscle action direction [29], [45]. The repetition frequency of the two scan lines for monitoring was finally achieved as 4.6 kHz with the 65 mm penetration depth. Thus the upper limit of shear wave velocity measurement was theoretically 69 m/s, if assuming that the minimal detectable time delay corresponded to 1 frame interval. This value corresponded to a shear modulus of more than 4000 kPa. In addition, the vibrator and the scanner were synchronized by the external trigger. The sampling frequency of the radio-frequency signal was 40 MHz. For each measurement, the subject only needed to maintain the contraction for less than 4 seconds, then 10,000 frames of data were collected and transferred to a computer for further analysis. The whole experimental setup also included a dynamometer. Isometric torque generated by the knee extensors was assessed using a HUMAC NORM rehabilitation system (Computer Sports Medicine, Inc., Stoughton, MA, USA), which included a specifically designed chair and a fixed dynamometer. The machine was set to the knee joint isolated movement pattern and isometric resistance mode. The knee joint angle can be set and fixed under this mode.

All radio-frequency signals were processed off-line using a custom-developed program of Matlab (Version R2008, MathWorks, Inc., MA, USA). The main processing steps can be summarized as followings: 1) To arrange the ultrasound signals obtained at the proximal and distal locations into segments; 2) To obtain the transient time shifts of each segment between two consecutive frames; 3) To calculate the displacement waveforms using the transient time shifts and the speed of ultrasound in soft tissue; 4) To detect the peaks of the sinusoidal displacement waveforms; 5) To detect the time delay between each pair of the peaks obtained at the same depth; 6) To calculate the overall time delay between the two waveforms by averaging all the time delay values; 7) To calculate the shear wave velocity using its propagation time and distance. The tissue displacement waveforms were determined by the normalized cross-correlation algorithm, which is also called the echo-tracking method and widely used in tissue displacement estimation [46], [47]. The method was based on time shift estimation between two congruent segments in pairs of consecutive frames of radio-frequency signals. The time shift was caused by the tissue displacement along the axial direction of ultrasound beam and subsequently the change of travelling distance of the reflected echoes. A segment of reference signal from the initial frame was first defined, and then the most similar segment to this reference one in the subsequent frames was searched using the cross-correlation calculation. The temporal locations of the maximum value of the normalized cross-correlation function marked the time shift between the two segments. Then the tissue displacement was estimated by multiplying the time shift with the velocity of ultrasound. When the time shifts were tracked continuously, a displacement waveform could be correspondingly obtained. The first frame signal was divided into segments each with 1 mm in depth and with 50% overlap. Each segment was treated as a reference segment and its movement was tracked frame by frame automatically using the cross-correlation method described above. Then the tissue displacement waveforms at certain depths were plotted with time for the distal and proximal locations, as shown in Fig. 3. Fig. 3(a) represents the tissue displacement waveform obtained at 0% MVC level (at rest), Fig. 3(b) at 50% MVC level, and Fig. 3(c) at 100% MVC level (corresponding to shear moduli of 9 kPa, 213 kPa, and 547 kPa). It can be observed that the time delay between the two waveforms became smaller when the contraction level increased, indicating that the shear wave moved faster. To measure this time delay, the peaks of the two displacement waveforms were detected using the zero-crossing points of their first-order derivatives, which were from greater-than-zero values to less-than-zero values. Then the positions of these peaks were plotted and used to determine the time delay values between the two waveforms. Shear wave consists of oscillations occurring perpendicular to the direction along its propagation. Since the shear wave fronts within the ROI were observed as straight lines perpendicular to the time axis, the shear wave propagation direction in VI muscle was confirmed to be perpendicular to the two ultrasound scan lines. That is why the shear wave velocity could be estimated by Δr and Δt using Eq. 2. Subsequently, Eq. 1 was used to calculate the shear modulus, with the generally used skeletal muscle density of 1000 kg/m3 [29].

Figure data removed from full text. Figure identifier and caption: 10.1371/journal.pone.0101769.g003 Typical tracking results of tissue displacement waveform of an elderly female human subject. (a) obtained under 0% MVC level (at rest), (b) 50% MVC level, and (c) 100% MVC level. The corresponding shear moduli for (a) to (c) were 9 kPa, 213 kPa, and 574 kPa. The solid line represents the tissue displacement waveforms detected at the proximal location, and the dashed line at the distal location, with reference to the vibration source.

Feasibility Tests on Silicone Phantoms: To evaluate the feasibility of the vibro-ultrasound system, shear moduli of several custom-made silicone phantoms with different stiffness were assessed. Their stiffness was compared between the proposed method and the conventional indentation method. Tissue-mimicking phantoms with a size of 100 mm×80 mm×20 mm were prepared for the experiment. The phantoms were made of addition-curing silicone rubbers RTV-2 (M4600 A/B, Wacker Chemicals Hong Kong Ltd., Hong Kong, China) and their stiffness was varied by adding silicone oil AK-35 (Wacker Chemicals Hong Kong Ltd., Hong Kong, China). The weight ratio between M4600A and AK-35 was selected as 1∶0, 1∶0.25, 1∶0.5, 1∶0.75 and 1∶1, with a decreasing stiffness of corresponding phantoms. The mixtures were then de-aerated in a vacuum cabinet until no more air bubbles were formed due to reduced air pressure. At last, the phantoms were heated at 60°C for several hours to increase the speed of curing. A total of ten phantoms were made (two for each concentration level). The shear moduli of these phantoms were first assessed using indentation method with a material testing machine (Instron ASTM Method Set, Braintree, MA, USA). The diameter of the indenter a is 10 mm. The phantoms were compressed for 2 mm deformation with a rate of 0.5 mm/sec and then relaxed at the same deformation rate. During three cycles of compression-relaxation, the compression load P (N) and the deformation W (mm) values were collected. Then the Young's modulus E was calculated using the Eq. 3, which is based on the Hayes model for the elastic indentation problem of a thin elastic layer bonded to a rigid half-space with a rigid, frictionless cylindrical plane-ended indenter [48]. (3)where h is the tissue thickness, and κ is a scaling factor, which provides a theoretical correction for the finite thickness of the measured phantom and it depends on both the ratio a/h and the Poisson's ratio ν. The Poisson's ratio ν was defined as 0.5 in this study since the silicone phantom is nearly an incompressible material. Then the shear modulus µ of the phantoms could be calculated by the following equation: (4)The indentation tests were performed for 3 times on each of the phantoms. Then the stiffness of each phantom was assessed using the vibro-ultrasound system, also for 3 times. To reduce the influence from upper and lower boundaries, the phantom to be measured was placed between two blocks of elastic silicone layers with thickness of approximately 35 mm and shear modulus of approximately 100 kPa. The ROI was 10 mm thick and located in the middle portion of the phantom. All the measurements were performed at room temperature (25±1°C). The shear moduli were averaged from the 3 measurements and the correlation between the results obtained by two methods were studied statistically. All the data were analyzed using SPSS Statistics (SPSS Inc. Chicago, IL, USA). Statistical significance was set at the 5% probability level.

Shear Wave Propagation Direction Validation Tests on Young Subjects: It should be confirmed that the shear wave propagates perpendicular to the ultrasound scan lines for the vibro-ultrasound system, so that its velocity can be estimated by a “time-to-flight” method. We assumed that the external disturbance can vibrate VI muscle fibers at different depths simultaneously and the induced shear wave propagates mainly in the muscle action direction. Otherwise, if the shear wave propagates as a spherical wave starting from the vibration source, it would reach the scan line with different propagation time at different depths. Thus when the distance between the two scan lines were fixed, different distance between the vibrator and the first scan line (in short “vibrator-beam distance”) will lead to the different value of the measured shear wave velocity. Accordingly, the experiment was designed to verify whether the vibrator-beam distance would affect the measured shear wave velocity on human subjects. Since this experiment was just to verify the feasibility of our approach, elderly subjects were not recruited this time. Ten healthy young subjects (8 males and 2 females, age: 30.7±4.1 yr, height: 170.2±10.7 cm, weight: 68.0±14.4 kg) were included in this experiment. The subject was asked to sit on the chair with several straps restraining his/her waist and shoulders. A cuff was fastened around the right lower leg and fixed to the lever of the dynamometer. The axis of the lever was aligned with the supposed rotation axis of the right knee joint. With the guidance of B-mode images, the vibrator and the ultrasound probe were hung right above the middle part of the RF muscle belly with a predefined distance (if this distance was 10 mm, the vibrator-beam distance was approximately 20 mm), as shown in Fig. 2 (right). Ultrasound gel was applied between the ultrasound probe and the skin. The ultrasound probe was first adjusted to be aligned in the direction along the muscle fibers under the guidance of B-mode images (The muscle fibers could be seen as parallel straight lines in the images. If the ultrasound plane was at an angle to the fibers, the fibers would not be shown as clear lines). Then the straight short push-bar was adjusted to be perpendicular to the probe and muscle fibers also under the guidance of ultrasound images. Both the push-bar and the probe were then rigidly fixed. With the help of this push-bar, planar pattern shear wave would be generated at the expected depth and propagate in the direction of muscle action [40]. The experiment was performed at a 90° knee joint angle. First, the MVC torque was assessed as the highest torque value produced from three successive isometric contractions which were maintained for 5 seconds with about 30 seconds interval for rest. Next, the muscle stiffness was assessed at relaxed condition and at 20% MVC level, with three different vibrator-beam distances, i.e. 15 mm, 20 mm and 25 mm. For each measurement, the subject was asked to maintain the isometric contraction for approximately 4 seconds, and three repeated measurements were made under the same condition with 1 minute interval for rest. The shear modulus was represented by the mean value of the three repeated measurements. The shear moduli of 10 subjects measured at different vibrator-beam distances were plotted using a linear correlation model, and then were analyzed using two-way repeated measure analyses of variance (ANOVA) to evaluate their differences. The normalized root mean squared deviation (NRMSD) among the results measured at different vibrator-beam distances was also calculated. The definition of NRMSD is as follows: (5)where xmax and xmin are the maximal and minimal values among the observed results. NRMSD value is often expressed as a percentage, where lower values indicate less residual variance.

Muscle Stiffness Measurements on Elderly and Young Female Subjects: Ten healthy elderly female subjects (age: 56.7±4.9 yr, height: 156.9±5.6 cm, weight: 58.9±8.4 kg) and ten healthy young female subjects (age: 27.6±5.0 yr, height: 164.3±4.4 cm, weight: 55.3±4.0 kg) volunteered to participate in this part of the study. The experimental setup was almost the same as described in the above section, and all the recruited subjects were also explained with the experimental protocol and asked to sign on the informed consent form prior to the experiment. However, to make the elderly subjects more comfortable, the experiment was performed at a 60° knee joint angle, but not 90°. The distance between the vibrator and the probe was set to be approximately 10 mm. The MVC torque value was also assessed first. Next, the muscle stiffness was measured for three times at relaxed condition. Then the subject was asked to maintain isometric contraction at different MVC levels, from 10% to 100%, with an increase of 10% for each step. At each MVC level, three assessments were performed with about 1 minute interval for rest. The shear modulus of each individual subject was represented by the mean value obtained from the three repeated measurements. Therefore, a total of 660 (20 [subjects] ×11 [contraction levels: 0%–100% MVC] ×3 [three times]) measurements of VI shear modulus were performed by the same investigator. The intra-class correlation coefficient (ICC) was used to evaluate the intra-observer repeatability. The shear moduli measured at the same contraction level across the ten elderly subjects and ten young subjects were then averaged and used to investigate the relationship between muscle stiffness and relative isometric contraction levels (% MVC). To determine the pattern of this relationship, polynomial regression analyses by linear, quadratic and cubic models were performed for each individual, and the coefficients of determination (R2) values of these models were compared using paired samples T-test. Since we found that the quadratic regression model had the best performance, the mean shear moduli across the ten subjects were then fitted with the relative isometric contraction levels (% MVC) using a quadratic regression model. To study the difference of the VI stiffness between elderly and young female subjects in a relaxed state and at different isometric contraction levels, two-way repeated measure analyses of variance (ANOVA) (Age [young and elder] × % MVC [0%–100%, 11 levels]) were used to analyze the measured shear modulus. Specially, the comparison of the VI shear modulus measured in a relaxed state (0% MVC) was first performed separately using one-way ANOVA method.

